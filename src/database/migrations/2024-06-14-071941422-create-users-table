-- Up

CREATE TABLE IF NOT EXISTS `users`
  (
    `id` INT UNSIGNED AUTO_INCREMENT NOT NULL,
    `uuid` BINARY(16) NOT NULL,
    `email` VARCHAR(255) NOT NULL,
    `phone` VARCHAR(32) NOT NULL,
    `password` VARCHAR(64) NOT NULL,
    `first_name` VARCHAR(255) NOT NULL,
    `last_name` VARCHAR(255) NOT NULL,
    `country_id` INT UNSIGNED NOT NULL,
    `phone_code_id` INT UNSIGNED NOT NULL,
    `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    CONSTRAINT `users_id_primary_key` PRIMARY KEY (`id`),
    CONSTRAINT `users_uuid_unique_key` UNIQUE (`uuid`),
    CONSTRAINT `users_email_unique_key` UNIQUE (`email`),
    CONSTRAINT `users_phone_phone_code_id_unique_key` UNIQUE (`phone`, `phone_code_id`),
    CONSTRAINT `users_country_id_foreign_key` FOREIGN KEY (`country_id`) REFERENCES `countries` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT `users_phone_code_id_foreign_key` FOREIGN KEY (`phone_code_id`) REFERENCES `phone_codes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
    INDEX `users_first_name_last_name_index` (`last_name`, `first_name`)
  ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

--- // ---

-- Down

DROP TABLE IF EXISTS `users`;
